{% from "VcareWebBundle:Product:macros.html.twig" import cart_quantity, item_tax, price_tax_item %}
{% import "@SyliusShop/Common/Macro/money.html.twig" as money %}

<table class="table table-striped table-bordered">
    <thead>
    <tr>
        <th>#</th>
        <th>{{ 'sylius.ui.item'|trans }}</th>
        <th class="text-align-right">{{ 'sylius.ui.price'|trans }}</span></th>
        <th class="text-align-center">{{ 'sylius.ui.qty'|trans }}</th>
        <th class="text-align-right">{{ 'sylius.ui.tax'|trans }}</th>
        <th class="text-align-right">{{ 'sylius.ui.total'|trans }}</th>
    </tr>
    </thead>
    <tbody>
        {% for item in order.items %}
            {% set product = item.product %}
            <tr>
                <td>{{ loop.index }}.</td>
                <td>{{ include('VcareWebBundle:Product:_variant.html.twig', {'variant': item.variant}) }}</td>
                <td class="text-align-right">
                    {% if item.unitPrice != item.discountedUnitPrice %}
                        <span class="regular-price">{{ price_tax_item(item.variant, item.unitPrice, item.taxTotal) }}</span>
                    {% endif %}
                    <span class="discounted-price">
                        {{ price_tax_item(item.variant, item.discountedUnitPrice, item.taxTotal) }}
                    </span>
                </td>
                <td class="text-align-center">{{ item.quantity }}</td>
                <td class="text-align-right">{{ item_tax(item.variant, item.taxTotal) }}</td>
                <td class="text-align-right">{{ money.convertAndFormat(item.subtotal) }}</td>
            </tr>
        {% endfor %}
    </tbody>
    <tfoot>
    <tr>
        <th class="text-align-right" colspan="5">{{ 'sylius.ui.tax_total'|trans }}</th>
        <td class="text-align-right">{{ money.convertAndFormat(order.taxTotal) }}</td>
    </tr>
    <tr>
        <th class="text-align-right" colspan="5">{{ 'sylius.ui.shipping_total'|trans }}</th>
        <td class="text-align-right">{{ money.convertAndFormat(order.shippingTotal) }}</td>
    </tr>

    {% if order.orderPromotionTotal %}
        <tr>
            <th class="text-align-right" colspan="5">{{ 'sylius.ui.promotion_total'|trans }}</th>
            <td class="text-align-right">
                {{ money.convertAndFormat(order.orderPromotionTotal) }}
            </td>
        </tr>
    {% endif %}

    <tr class="grand-total">
        <th class="text-align-right" colspan="5">{{ 'sylius.ui.total'|trans }}</th>
        <td class="text-align-right">{{ money.convertAndFormat(order.total) }}</td>
    </tr>
    </tfoot>
</table>
